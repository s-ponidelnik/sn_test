var addUser=function(e,t,a,s,d){var n=$("table#users").find("tbody").append($('<tr class="user" data-id="'+e+'">'));n.append($('<td class="id">').text(e)),n.append($('<td class="username btn-user-view" data-id="'+e+'">').text(t)),n.append($('<td class="avatar">').append($('<img class="small-user-avatar">').attr("src",a))),n.append($('<td class="created_at">').text(s))},startLoading=function(){$("body").loading({stoppable:!1})},stopLoading=function(){$("body").loading("stop")},clearTable=function(){$("table#users").find("tbody").html("")},userHide=function(e,t){startLoading(),$.ajax({url:"http://backend.localhost/hide_user",data:{id:e,hide:t},method:"POST",context:document.body}).done(function(e){stopLoading(),"undefined"!==e.status&&"undefined"!==e.status.code&&e.status.text?200===e.status.code?$("#modalUserIsHideChecked").attr("checked",e.result):alert(e.status.code+": "+e.status.text):alert("Unknown error")})},searchUser=function(e,t){""!==e&&(startLoading(),$.ajax({url:"http://backend.localhost/users",data:{username:e,show_hidden:1*t},method:"GET",context:document.body}).done(function(e){stopLoading(),clearTable(),"undefined"!==e.status&&"undefined"!==e.status.code&&e.status.text?200===e.status.code?$.each(e.result,function(e,t){addUser(t.id,t.username,t.avatar_url,t.created_at.date+"("+t.created_at.timezone+")",t.is_hide)}):alert(e.status.code+": "+e.status.text):alert("Unknown error")}))};$(document).on("keypress","input#search",function(e){13===e.which&&searchUser($("input#search").val(),$("#show_hidden_checkbox").is(":checked"))}),$(document).on("click",".btn-search",function(){searchUser($("input#search").val(),$("#show_hidden_checkbox").is(":checked"))}),$(document).on("click",".search-form-reset-btn",function(){document.location="/"}),$(document).on("change","#modalUserIsHideChecked",function(){userHide($(this).attr("data-user-id"),$("#modalUserIsHideChecked").is(":checked"))}),$(document).on("change","#show_hidden_checkbox",function(){searchUser($("input#search").val(),$("#show_hidden_checkbox").is(":checked"))}),$(document).on("click",".btn-user-view",function(){var e=$(this).attr("data-id");startLoading(),$.ajax({url:"http://backend.localhost/user",data:{id:e},method:"GET",context:document.body}).done(function(e){stopLoading(),"undefined"!==e.status&&"undefined"!==e.status.code&&e.status.text?200===e.status.code?($(".user-modal-container .id").text(e.result.id),$(".user-modal-container .username").text(e.result.username),null!==e.result.avatar_url?$(".user-modal-container .avatar img").attr("src",e.result.avatar_url):$(".user-modal-container .avatar img").attr("src","/images/no-person.jpg"),$(".user-modal-container .created_at").text(e.result.created_at.date+" ("+e.result.created_at.timezone+")"),e.result.is_hide?$("#modalUserIsHideChecked").attr("data-user-id",e.result.id).attr("checked",!0):$("#modalUserIsHideChecked").attr("data-user-id",e.result.id).attr("checked",!1),$("#userModal").modal()):alert(e.status.code+": "+e.status.text):alert("Unknown error")})}),$(document).ready(function(){$("#users").DataTable({pagingType:"simple_numbers",searching:!1,ordering:!1}),$(".dataTables_length").addClass("bs-select")});